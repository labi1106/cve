# Vulnerability Description

The `tryAuthenticateWithCookies` method in the `AuthenticationInterceptor.java` file of Xiaozhi ESP32 Server Java v3.0.0 contains a high-risk authentication bypass vulnerability. This method only checks whether the request cookie contains a `username` field, but does not verify the password, token, cookie signature, validity/expiration time. An attacker can bypass the authentication mechanism directly by forging a cookie containing any `username` value (e.g., `username=admin`), illegally obtain the corresponding user's session privileges, and access all API interfaces that require authentication (e.g., `/api/user/queryUsers`), leading to unauthorized access, leakage of sensitive information, or even unauthorized operations.

# Vulnerability Analysis

The vulnerability is in the class file src/main/java/com/xiaozhi/common/interceptor/AuthenticationInterceptor.java. Direct authentication here doesn't verify the password; we only need to add `Cookie: username=admin(username)` to the request to directly access the backend.

![](https://github.com/labi1106/picx-images-hosting/raw/master/20251128/image.9gx0ehsbqg.webp)

# Vulnerability Reproduction

Vulnerable URL: http://120.26.30.62/api/config/query?start=1&limit=10&configType=12m&provider=&modelType= (Before adding cookies)

![](https://github.com/labi1106/picx-images-hosting/raw/master/20251128/image.3620gm3nqk.webp)

After adding cookies

![](https://github.com/labi1106/picx-images-hosting/raw/master/20251128/image.4qrrg310kl.webp)

