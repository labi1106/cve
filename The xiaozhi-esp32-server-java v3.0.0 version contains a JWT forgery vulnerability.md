# Vulnerability Description

The JWT authentication mechanism in xiaozhi-esp32-server-java v3.0.0 has a serious security vulnerability. Attackers can obtain the hard-coded default key, forge any user's JWT token, and completely bypass authentication.

# Vulnerability Analysis

Vulnerable class file: src/main/java/com/xiaozhi/utils/JwtUtil.java

Vulnerability 1: Hardcoded default key

![](https://github.com/labi1106/picx-images-hosting/raw/master/20251128/image.7axlsrjsn6.webp)

Vulnerability 2: The key is read from the configuration file. If no key is configured, the default value is used. If jwt.secret is not set in the configuration file, the default key is used.

![](https://github.com/labi1106/picx-images-hosting/raw/master/20251128/image.2h8qwmz7kz.webp)

JWT's verification logic

![](https://github.com/labi1106/picx-images-hosting/raw/master/20251128/image.2dp4yx68tj.webp)

# Vulnerability Reproduction

If a registered user logs in randomly and their key is compromised, an attacker could use the same key to forge a token and gain administrator privileges.

![](https://github.com/labi1106/picx-images-hosting/raw/master/20251128/image.4n85ier40s.webp)

